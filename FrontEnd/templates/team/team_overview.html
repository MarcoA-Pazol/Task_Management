{% extends 'layouts/base.html' %}

{% block content %}

    <!--This is for load styles, scripts and more from static directory.-->
    {% load static %}
    <link rel="stylesheet" href="{% static 'styles/team_overview.css' %}">
    <script src="{% static 'scripts/team.js' %}"></script>

    <aside class="team_options_menu">
        <ul>
            <a href="{% url "team" %}"><li><h2>Overview</h2></li></a>
            <a href="{% url "join_team" %}"><li><h2>Join on a team</h2></li></a>
            <a href="{% url "create_team" %}"><li><h2>Create team</h2></li></a>
            <a href="{% url "edit_team" %}"><li><h2>Edit team</h2></li></a>
        </ul>
    </aside>

    <!--This content will be displayed depending the chosen option on left menu "team_options_menu"-->
    <div class="team_container">
        <div class="team_overview">
            <h1>{{ team.name }}</h1>
            <h2>Leader: {{ team.owner.username }}</h2>
            <p><b>ã„¸</b> {{ team.description }}</p>
            <ul>
                <h2>Members:</h2>
                {% for member in members %}
                    {% if is_owner == False %}
                        <li><b>ðŸ’ </b>   {{ member.username }} </li>
                    {% else %}
                        {% if member.username == team.owner.username%}
                            <li><b>ðŸ’ </b>   {{ member.username }}</li>
                        {% else %}
                            <li>
                                <b>ðŸ’ </b>   
                                {{ member.username }} 
                                <form method="POST" action="{% url 'kickout_member' team_identifier=team.name member_identifier=member.username %}" style="display:inline;">
                                    {% csrf_token %}
                                    <button type="submit" id="remove_member_button">Kick-Out</button>
                                </form>
                            </li>
                        {% endif %}
                    {% endif %}
                {% endfor %}
            </ul>
            {% if is_owner %}
                <a href="{% url 'edit_team' %}"><button id="team_edit_button">Update</button></a>
                <form method="POST" action="{% url 'delete_team' team_identifier=team.name %}" id="delete_team_form">
                    {% csrf_token %}
                    <button type="submit" id="delete_team_button">Delete Team</button>
                </form>
            {% else %}
            <form method="POST" action="{% url 'team_overview' team_identifier=team.name %}" id="leave_team_form">
                {% csrf_token %}
                <button type="submit" id="leave_team_button">Leave Team</button>
            </form>
            {% endif %}
        </div>

        
        {% if is_owner %}
            <div class="members_to_invite">
                <h2>Add Member To Your Team</h2>
                <h4><b>ðŸ›ˆ</b> Invite members to your Team here by click on 'Invite' button. Just habilitied same departament workers.</h4>
                <div>
                    {% if members_to_invite %}
                        <ul>
                            {% for member in members_to_invite %}
                                {% if member not in members %}
                                    <li>
                                        <h3>{{member.username}} <b>/</b> {{member.occupation}}</h3>
                                        <form method="POST" action="{% url 'invite_member' team_identifier=team.name member_identifier=member.username %}" style="display:inline;">
                                            {% csrf_token %}
                                            <button type="submit" id="invite_member_button">Invite</button>
                                        </form>
                                    </li>
                                {% endif %}
                            {% endfor %}
                        </ul>
                    {% else %}
                            <h5><p></p>There are not members for your departament to be invited.</h5>
                    {% endif %}
                    {% if members %}
                            <hr>
                            {% for member in members %}
                                <h6><b>{{member.username}}</b> is in your Team</h6>
                            {% endfor %}
                    {% endif %}
                </div>
            </div>
        {% endif %}
    </div>

{% endblock %}